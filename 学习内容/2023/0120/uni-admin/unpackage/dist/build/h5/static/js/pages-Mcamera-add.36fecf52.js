(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-Mcamera-add"],{1563:function(e,t,a){"use strict";a.r(t);var r=a("969c"),n=a("712d");for(var u in n)["default"].indexOf(u)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(u);var i=a("f0c5"),l=Object(i["a"])(n["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=l.exports},"34a7":function(e,t,a){"use strict";(function(e,r){a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.codeeditid=function(e){return"200"==e||"400"==e?e:"success"},t.gettreedata=function(e,t){return c.apply(this,arguments)},t.phonevalue=function(e,t){return d.apply(this,arguments)},t.relevance=function(e){return s.apply(this,arguments)},a("a9e3");var u=n(a("5530")),i=n(a("c7eb")),l=n(a("1da1")),o=e.database();function c(){return c=(0,l.default)((0,i.default)().mark((function e(t,a){var n,u;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=["Mcamera","Mmoney"],e.next=3,o.collection(n[t]).where(a).get();case 3:return u=e.sent,r.log(u.result.data),e.abrupt("return",u.result.data);case 6:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function s(){return s=(0,l.default)((0,i.default)().mark((function e(t){var a,n,u;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.detail.value[2]){e.next=4;break}return e.abrupt("return","200");case 4:return a=t.detail.value[2].value,e.next=7,o.collection("Mparameter").where("title=='".concat(a,"'")).field("_id").get({getOne:!0});case 7:if(n=e.sent,r.log(n),n.result.data){e.next=13;break}return e.abrupt("return","400");case 13:return u=n.result.data._id,e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function d(){return d=(0,l.default)((0,i.default)().mark((function e(t,a){var n,l,c,s,d,f,m,v=arguments;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=v.length>2&&void 0!==v[2]?v[2]:0,l={},l.phone_id=t.title,e.next=5,o.collection("Msoc").where("_id=='".concat(t.socfunction,"'")).field("_id,socvalue").get({getOne:!0});case 5:return c=e.sent,l.phonefunction=String(c.result.data.socvalue),s=t.weight,d=Number(t.measurementHight)*Number(t.measurementWidth)*Number(t.measurementThickness),l.light_thin=String(s*d/1e4),f=Number(t.screenPPI)*Number(t.screenMaterial)/50+(Number(t.screenRenovate)-60)/60+Number(t.screenAdmin)/10-1,l.phoneshow=String(Number(f.toFixed(2))),e.next=14,o.collection("Mcamera").where("phone_id=='".concat(t.title,"'")).groupBy("phone_id").groupField("sum(add(Comeravalue,Comeraadd)) as sumScore ").get({getOne:!0});case 14:m=e.sent,l.phoneimage=String(m.result.data.sumScore),l.phonecell=String(t.cell),l.phonecharge=String(Number(t.WiredCharging)+Number(t.WirelessCharging)/4),n?o.collection("Mphonevalue").doc(a).update((0,u.default)((0,u.default)({},l),{},{last_date:Date.now()})).then((function(e){r.log("修改",e)})).catch((function(e){r.log("修改失败",e)})):o.collection("Mphonevalue").add((0,u.default)({},l)).then((function(e){r.log("上传",e)})).catch((function(e){r.log("上传失败",e)}));case 19:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}}).call(this,a("a9ff")["default"],a("5a52")["default"])},"712d":function(e,t,a){"use strict";a.r(t);var r=a("cdb6"),n=a.n(r);for(var u in r)["default"].indexOf(u)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(u);t["default"]=n.a},"969c":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return r}));var r={uniForms:a("2b75").default,uniFormsItem:a("4194").default,uniDataPicker:a("9aad").default,uniEasyinput:a("8e06").default,uniDataCheckbox:a("ddbd").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"uni-container"},[a("uni-forms",{ref:"form",attrs:{model:e.formData,validateTrigger:"bind"}},[a("uni-forms-item",{attrs:{name:"phone_id",label:"名称"}},[a("uni-data-picker",{attrs:{collection:"Manufacturer_brand","parent-field":"parent_id.value",placeholder:"请选择型号","self-field":"_id",field:"_id as value, name as text"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.onchange.apply(void 0,arguments)}},model:{value:e.formData.phone_id,callback:function(t){e.$set(e.formData,"phone_id",t)},expression:"formData.phone_id"}})],1),a("uni-forms-item",{attrs:{name:"edit",label:"关联"}},[a("uni-easyinput",{attrs:{disabled:!0,placeholder:"参数关联"},model:{value:e.formData.edit,callback:function(t){e.$set(e.formData,"edit",t)},expression:"formData.edit"}})],1),a("uni-forms-item",{attrs:{name:"ComeraType",label:"类型",required:!0}},[a("uni-data-checkbox",{attrs:{min:1,multiple:!0,localdata:e.formOptions.ComeraType_localdata},model:{value:e.formData.ComeraType,callback:function(t){e.$set(e.formData,"ComeraType",t)},expression:"formData.ComeraType"}})],1),a("uni-forms-item",{attrs:{name:"Comeraedit",label:"详情",required:!0}},[a("uni-easyinput",{attrs:{placeholder:"相机详情"},model:{value:e.formData.Comeraedit,callback:function(t){e.$set(e.formData,"Comeraedit",t)},expression:"formData.Comeraedit"}})],1),a("uni-forms-item",{attrs:{name:"Comeravalue",label:"数值",required:!0}},[a("uni-easyinput",{attrs:{placeholder:"相机数值644",type:"number"},model:{value:e.formData.Comeravalue,callback:function(t){e.$set(e.formData,"Comeravalue",t)},expression:"formData.Comeravalue"}})],1),a("uni-forms-item",{attrs:{name:"Comeraadd",label:"附加分"}},[a("uni-easyinput",{attrs:{placeholder:"特别加分",type:"number"},model:{value:e.formData.Comeraadd,callback:function(t){e.$set(e.formData,"Comeraadd",t)},expression:"formData.Comeraadd"}})],1),a("uni-forms-item",{attrs:{name:"sort",label:"排序"}},[a("uni-easyinput",{attrs:{type:"number"},model:{value:e.formData.sort,callback:function(t){e.$set(e.formData,"sort",t)},expression:"formData.sort"}})],1),a("v-uni-view",{staticClass:"uni-button-group"},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交")]),a("v-uni-navigator",{staticStyle:{"margin-left":"15px"},attrs:{"open-type":"navigateBack"}},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"}},[e._v("返回")])],1)],1)],1)],1)},u=[]},cb79:function(e,t,a){"use strict";a("7a82");var r=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.enumConverter=void 0,t.filterToWhere=function(e,t){var a={};for(var r in e){var i=e[r],l=i.type,o=i.value;switch(l){case"search":"string"===typeof o&&o.length&&(a[r]=new RegExp(o));break;case"select":if(o.length){var c,s=[],d=(0,u.default)(o);try{for(d.s();!(c=d.n()).done;){var f=c.value;s.push(t.eq(f))}}catch(_){d.e(_)}finally{d.f()}a[r]=t.or(s)}break;case"range":if(o.length){var m=o[0],v=o[1];a[r]=t.and([t.gte(m),t.lte(v)])}break;case"date":if(o.length){var p=(0,n.default)(o,2),h=p[0],b=p[1],g=new Date(h),x=new Date(b);a[r]=t.and([t.gte(g),t.lte(x)])}break;case"timestamp":if(o.length){var y=(0,n.default)(o,2),C=y[0],w=y[1];a[r]=t.and([t.gte(C),t.lte(w)])}break}}return a},t.validator=void 0;var n=r(a("3835")),u=r(a("b85c"));a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("25f0"),a("14d9");t.validator={phone_id:{rules:[{format:"string"}],title:"名称",label:"名称"},edit:{rules:[{format:"string"}],title:"关联",label:"关联"},ComeraType:{rules:[{required:!0},{format:"array"},{minLength:1},{range:[{text:"前置",value:0},{text:"主摄",value:1},{text:"长焦",value:2},{text:"广角",value:3},{text:"人像",value:4},{text:"微距",value:5},{text:"景深",value:6},{text:"其他",value:7}]}],title:"类型",label:"类型"},Comeraedit:{rules:[{required:!0},{format:"string"}],title:"详情",label:"详情"},Comeravalue:{rules:[{required:!0},{format:"int"}],title:"数值",label:"数值"},Comeraadd:{rules:[{format:"int"}],title:"附加分",defaultValue:0,label:"附加分"},sort:{rules:[{format:"int"}],title:"排序",defaultValue:0,label:"排序"}};t.enumConverter={ComeraType_valuetotext:[{text:"前置",value:0},{text:"主摄",value:1},{text:"长焦",value:2},{text:"广角",value:3},{text:"人像",value:4},{text:"微距",value:5},{text:"景深",value:6},{text:"其他",value:7}]}},cdb6:function(e,t,a){"use strict";(function(e){a("7a82");var r=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("c7eb")),u=r(a("1da1")),i=r(a("5530"));a("caad"),a("2532"),a("b64b"),a("d3b7");var l=a("cb79"),o=a("34a7"),c=e.database();c.command;function s(e){var t={};for(var a in l.validator)e.includes(a)&&(t[a]=l.validator[a]);return t}var d={data:function(){var e={phone_id:"",edit:"",ComeraType:[],Comeraedit:"",Comeravalue:null,Comeraadd:0,sort:0};return{formData:e,formOptions:{ComeraType_localdata:[{text:"前置",value:0},{text:"主摄",value:1},{text:"长焦",value:2},{text:"广角",value:3},{text:"人像",value:4},{text:"微距",value:5},{text:"景深",value:6},{text:"其他",value:7}]},rules:(0,i.default)({},s(Object.keys(e)))}},onReady:function(){this.$refs.form.setRules(this.rules)},methods:{onchange:function(e){var t=this;return(0,u.default)((0,n.default)().mark((function a(){var r;return(0,n.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,o.relevance)(e);case 2:if(r=a.sent,"200"!=r){a.next=6;break}return setTimeout((function(){t.formData.phone_id=null}),800),a.abrupt("return");case 6:t.formData.edit=r;case 7:case"end":return a.stop()}}),a)})))()},submit:function(){var e=this;uni.showLoading({mask:!0}),this.$refs.form.validate().then((function(t){return e.submitForm(t)})).catch((function(){})).finally((function(){uni.hideLoading()}))},submitForm:function(e){var t=this;return c.collection("Mcamera").add(e).then((function(e){uni.showToast({title:"新增成功"}),t.getOpenerEventChannel().emit("refreshData"),setTimeout((function(){return uni.navigateBack()}),500)})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})}))}}};t.default=d}).call(this,a("a9ff")["default"])}}]);