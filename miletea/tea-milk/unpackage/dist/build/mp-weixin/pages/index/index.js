(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{2059:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={uSkeleton:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-skeleton/u-skeleton")]).then(n.bind(null,"0561"))},uSticky:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-sticky/u-sticky")]).then(n.bind(null,"01ef"))},uTabs:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-tabs/u-tabs")]).then(n.bind(null,"b972"))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"547e"))},uEmpty:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-empty/u-empty")]).then(n.bind(null,"f1fb"))},list:function(){return n.e("components/list/list").then(n.bind(null,"547f"))},uLoadmore:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loadmore/u-loadmore")]).then(n.bind(null,"8170"))}},r=function(){var e=this.$createElement,t=(this._self._c,this.loading?null:this.data.length);this.$mp.data=Object.assign({},{$root:{g0:t}})},a=[]},"2d3d":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("e1b3"),n("4a2a"),n("a9ff");o(n("66fd"));var r=o(n("ca80"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"2def":function(e,t,n){},"6d2c":function(e,t,n){"use strict";n.r(t);var o=n("bca1"),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},aa42:function(e,t,n){"use strict";var o=n("2def"),r=n.n(o);r.a},bca1:function(e,t,n){"use strict";(function(e,o){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("2eee")),u=r(n("9523")),i=r(n("448a")),s=r(n("c973")),c=n("efb0"),l=n("b0d3"),d=n("c228");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,u.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=e.database(),p={data:function(){return{id:"",current:"0",loading:!0,classlist:[{name:"若无数据"},{name:"请手动下拉刷新"}],data:[],noMore:!1,more:!1,status:"loadmore",loadingText:"努力加载中",loadmoreText:"轻轻上拉",nomoreText:"实在没有了"}},onLoad:function(){var e=this;o.startPullDownRefresh(),this.noMore=!1,setTimeout((function(){e.loading=!1}),1e3)},onShow:function(){o.$u.mpShare.title="奶茶奇缘",o.$u.mpShare.imageUrl="/static/logomt.png"},onPullDownRefresh:function(){if(!(0,d.interval)(5e3))return o.stopPullDownRefresh();this.classlist=[],this.data=[],this.getclass()},onReachBottom:function(){if(this.more)return this.status="noMore";console.log("触底"),this.getyuntea(this.id),this.status="loading"},methods:{getclass:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var n,r;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.collection("tea-milk-class").where("state==true").field("_id as id,name as name ,sort").orderBy("sort desc").get();case 2:n=t.sent,e.classlist=n.result.data,o.stopPullDownRefresh(),r=n.result.data[e.current],e.getyuntea(r),e.id=n.result.data[e.current];case 8:case"end":return t.stop()}}),t)})))()},gosearch:function(e){o.navigateTo({url:"/pages/search/search?type="+e})},click:function(e){this.current=e.index,this.data=[],this.noMore=!1,this.notification("加载中"),this.fangdou(e),this.id=e},notification:function(e){o.showLoading({title:e||"加载中"})},fangdou:(0,l.debounce)((function(e){this.getyuntea(e)}),1e3),getyuntea:function(e){var t=this;return(0,s.default)(a.default.mark((function n(){var r,u,s,l,d;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.more=!1,t.status="loadmore",r=t.data.length,u="category_id=='".concat(e.id,"'&&state==true"),n.next=6,(0,c.getdata)(u,r,6);case 6:s=n.sent,l=s.result.data,d=[].concat((0,i.default)(t.data),(0,i.default)(l)),d.length==s.result.count&&(t.more=!0,t.status="nomore",o.hideLoading()),t.data=d.map((function(t){return m(m({},t),{},{class:e.name})})),o.hideLoading(),t.loading=!1,d.length<=4?t.noMore=!1:t.noMore=!0;case 14:case"end":return n.stop()}}),n)})))()}}};t.default=p}).call(this,n("a9ff")["default"],n("543d")["default"])},ca80:function(e,t,n){"use strict";n.r(t);var o=n("2059"),r=n("6d2c");for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("aa42");var u=n("f0c5"),i=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=i.exports}},[["2d3d","common/runtime","common/vendor"]]]);